{
  "sql": "WITH confidence_analysis AS (\n    SELECT \n        ROUND(CONFIDENCE_LEVEL, 2) as confidence_bin,\n        COUNT(*) as total_attempts,\n        SUM(CASE WHEN TARGET = 1 THEN 1 ELSE 0 END) as successes,\n        COUNT(DISTINCT INDIVIDUALID) as unique_individuals,\n        COUNT(CREDIT_RATING) as credit_data_points,\n        COUNT(PART_AFFILIATION) as political_data_points,\n        AVG(CASE WHEN HH_INCOME IS NOT NULL AND AGE IS NOT NULL AND GENDER IS NOT NULL THEN 1 ELSE 0 END) as core_demo_coverage,\n        MODE(BUBBLES) as most_common_bubble\n    FROM DM_CAMPAIGN\n    WHERE CONFIDENCE_LEVEL IS NOT NULL\n    GROUP BY ROUND(CONFIDENCE_LEVEL, 2)\n),\nconfidence_metrics AS (\n    SELECT \n        confidence_bin,\n        total_attempts,\n        successes,\n        ROUND((successes::FLOAT / total_attempts) * 100, 2) as success_rate,\n        ROUND((credit_data_points::FLOAT / total_attempts) * 100, 2) as credit_coverage_pct,\n        ROUND((political_data_points::FLOAT / total_attempts) * 100, 2) as political_coverage_pct,\n        ROUND(core_demo_coverage * 100, 2) as core_demo_coverage_pct,\n        most_common_bubble\n    FROM confidence_analysis\n)\nSELECT *\nFROM confidence_metrics\nWHERE total_attempts >= 100  -- Filter for statistical significance\nORDER BY success_rate DESC\nLIMIT 15",
  "reasoning": "This query aims to deeply analyze the relationship between confidence scores and various data completeness metrics, building on several key findings from previous queries:\n\n1. We've seen that confidence scores correlate with success but haven't quantified this relationship precisely\n2. We've observed varying data coverage across different fields\n3. We've noted that some bubbles perform better than others\n\nSpecifically, this query will help us understand:\n\n- The precise relationship between confidence scores and success rates\n- Whether higher confidence scores correlate with better data coverage\n- If certain bubbles are overrepresented in high-confidence predictions\n- The minimum data requirements for high-confidence predictions\n\nKey features of the query:\n- Rounds confidence scores to reduce noise and create meaningful bins\n- Calculates multiple coverage metrics (credit, political, core demographics)\n- Filters for statistical significance (100+ attempts)\n- Identifies the most common bubble for each confidence level\n\nThis analysis will help determine:\n- Whether the confidence score is a reliable predictor of success\n- If data completeness is a prerequisite for high confidence\n- Whether the model shows bubble-specific bias in its confidence assignments\n\nThese insights could lead to practical improvements in the targeting model and data collection strategies."
}